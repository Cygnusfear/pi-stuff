---
id: p-2b56
status: closed
deps: []
links: []
created: 2026-02-25T12:27:15Z
type: task
priority: 2
assignee: impl-1
tags: [team]
---
# You are impl-1. Working directory: /Users/alexander/Projects/totalrecall-rs

IMPORTANT: Do NOT self-review, do NOT create review tickets, do NOT use code-review skill, NEVER run find/fd on repo root.

## Task

Fix the timestamp bug in queue.rs and add a test.

### Fix 1: src/synthesis/queue.rs line 260

The variable `first_seen` is already correctly computed at line 236-237:
```rust
let first_seen = crate::timestamps::first_seen_from_raw_content(&raw_contents);
```

But at line 260, the struct field uses `now` instead:
```rust
first_seen: now,
```

Change line 260 from `first_seen: now,` to `first_seen,` (which uses the correctly computed variable via Rust's field init shorthand).

### Fix 2: Add a test in src/timestamps.rs

Add a test `test_first_seen_from_raw_content_picks_earliest` that creates 3 RawContent entries with timestamps [3000, 1000, 2000] and asserts first_seen_from_raw_content returns 1000. Use the existing tests in that file as reference for the RawContent struct construction.

### Steps
1. Read src/synthesis/queue.rs around lines 255-265
2. Change `first_seen: now,` to `first_seen,` on line 260
3. Read src/timestamps.rs tests section
4. Add the new test
5. Run `cargo test --lib` to verify all tests pass
6. Commit: `git add -A && git commit -m 'fix(synthesis): use derived first_seen instead of wall clock in queue processor'`

Do NOT change temporal.rs — it's already correct.

You are impl-1. Working directory: /Users/alexander/Projects/totalrecall-rs

IMPORTANT: Do NOT self-review, do NOT create review tickets, do NOT use code-review skill, NEVER run find/fd on repo root.

## Task

Fix the timestamp bug in queue.rs and add a test.

### Fix 1: src/synthesis/queue.rs line 260

The variable `first_seen` is already correctly computed at line 236-237:
```rust
let first_seen = crate::timestamps::first_seen_from_raw_content(&raw_contents);
```

But at line 260, the struct field uses `now` instead:
```rust
first_seen: now,
```

Change line 260 from `first_seen: now,` to `first_seen,` (which uses the correctly computed variable via Rust's field init shorthand).

### Fix 2: Add a test in src/timestamps.rs

Add a test `test_first_seen_from_raw_content_picks_earliest` that creates 3 RawContent entries with timestamps [3000, 1000, 2000] and asserts first_seen_from_raw_content returns 1000. Use the existing tests in that file as reference for the RawContent struct construction.

### Steps
1. Read src/synthesis/queue.rs around lines 255-265
2. Change `first_seen: now,` to `first_seen,` on line 260
3. Read src/timestamps.rs tests section
4. Add the new test
5. Run `cargo test --lib` to verify all tests pass
6. Commit: `git add -A && git commit -m 'fix(synthesis): use derived first_seen instead of wall clock in queue processor'`

Do NOT change temporal.rs — it's already correct.


## Notes

**2026-02-25T12:29:38Z**

DONE: Fixed timestamp bug in queue.rs (line 260: changed `first_seen: now` to `first_seen,` to use the derived earliest timestamp instead of wall clock). Added test `test_first_seen_from_raw_content_picks_earliest` in timestamps.rs — verifies [3000,1000,2000] returns 1000. All 6 timestamp tests pass. Committed to main.

**2026-02-25T12:29:46Z**

DONE: Task completed.
